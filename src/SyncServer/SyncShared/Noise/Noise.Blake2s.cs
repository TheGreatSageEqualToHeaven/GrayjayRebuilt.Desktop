// SyncShared, Version=1.6.0.0, Culture=neutral, PublicKeyToken=null
// Noise.Blake2s

using System.Buffers.Binary;
using System.Runtime.InteropServices;

namespace Noise;

internal sealed class Blake2s : Hash, IDisposable
{
    private const uint IV0 = 1779033703u;

    private const uint IV1 = 3144134277u;

    private const uint IV2 = 1013904242u;

    private const uint IV3 = 2773480762u;

    private const uint IV4 = 1359893119u;

    private const uint IV5 = 2600822924u;

    private const uint IV6 = 528734635u;

    private const uint IV7 = 1541459225u;

    private const int OutputSize = 32;

    private const int BlockSize = 64;

    private const int FanOut = 1;

    private const int MaxHeight = 1;

    private const int Config = 16842784;

    private readonly byte[] buffer = new byte[64];

    private readonly uint[] h = new uint[8];

    private readonly uint[] m = new uint[16];

    private uint f;

    private int position;

    private uint t0;

    private uint t1;

    public Blake2s()
    {
        Reset();
    }

    public int HashLen => 32;

    public int BlockLen => 64;

    public void AppendData(ReadOnlySpan<byte> data)
    {
        if (!data.IsEmpty)
        {
            var span = buffer.AsSpan();
            var num = 64 - position;
            if (position > 0 && data.Length > num)
            {
                data.Slice(0, num).CopyTo(span.Slice(position));
                t0 += 64u;
                t1 += t0 == 0 ? 1u : 0u;
                Compress(span);
                data = data.Slice(num);
                position = 0;
            }

            while (data.Length > 64)
            {
                t0 += 64u;
                t1 += t0 == 0 ? 1u : 0u;
                Compress(data.Slice(0, 64));
                data = data.Slice(64);
            }

            if (data.Length > 0)
            {
                data.CopyTo(span.Slice(position));
                position += data.Length;
            }
        }
    }

    public void GetHashAndReset(Span<byte> hash)
    {
        t0 += (uint)position;
        f = uint.MaxValue;
        buffer.AsSpan(position).Fill(0);
        Compress(buffer);
        MemoryMarshal.AsBytes(h.AsSpan()).CopyTo(hash);
        Reset();
    }

    public void Dispose()
    {
    }

    private void Reset()
    {
        h[0] = 1795745351u;
        h[1] = 3144134277u;
        h[2] = 1013904242u;
        h[3] = 2773480762u;
        h[4] = 1359893119u;
        h[5] = 2600822924u;
        h[6] = 528734635u;
        h[7] = 1541459225u;
        t0 = 0u;
        t1 = 0u;
        f = 0u;
        Array.Clear(buffer, 0, buffer.Length);
        position = 0;
    }

    private void Compress(ReadOnlySpan<byte> block)
    {
        var array = h;
        var array2 = m;
        if (BitConverter.IsLittleEndian)
            block.CopyTo(MemoryMarshal.AsBytes(array2.AsSpan()));
        else
            for (var i = 0; i < 16; i++)
            {
                array2[i] = BinaryPrimitives.ReadUInt32BigEndian(block);
                block = block.Slice(4);
            }

        var num = array[0];
        var num2 = array[1];
        var num3 = array[2];
        var num4 = array[3];
        var num5 = array[4];
        var num6 = array[5];
        var num7 = array[6];
        var num8 = array[7];
        var num9 = 1779033703u;
        var num10 = 3144134277u;
        var num11 = 1013904242u;
        var num12 = 2773480762u;
        var num13 = 0x510E527F ^ t0;
        var num14 = 0x9B05688Cu ^ t1;
        var num15 = 0x1F83D9AB ^ f;
        var num16 = 1541459225u;
        num = num + num5 + array2[0];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[1];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[2];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[3];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[4];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[5];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[6];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[7];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[8];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[9];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[10];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[11];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[12];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[13];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[14];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[15];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[14];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[10];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[4];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[8];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[9];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[15];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[13];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[6];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[1];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[12];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[0];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[2];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[11];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[7];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[5];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[3];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[11];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[8];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[12];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[0];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[5];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[2];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[15];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[13];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[10];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[14];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[3];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[6];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[7];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[1];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[9];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[4];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[7];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[9];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[3];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[1];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[13];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[12];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[11];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[14];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[2];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[6];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[5];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[10];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[4];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[0];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[15];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[8];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[9];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[0];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[5];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[7];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[2];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[4];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[10];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[15];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[14];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[1];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[11];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[12];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[6];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[8];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[3];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[13];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[2];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[12];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[6];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[10];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[0];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[11];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[8];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[3];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[4];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[13];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[7];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[5];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[15];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[14];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[1];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[9];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[12];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[5];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[1];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[15];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[14];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[13];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[4];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[10];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[0];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[7];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[6];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[3];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[9];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[2];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[8];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[11];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[13];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[11];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[7];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[14];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[12];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[1];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[3];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[9];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[5];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[0];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[15];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[4];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[8];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[6];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[2];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[10];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[6];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[15];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[14];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[9];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[11];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[3];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[0];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[8];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[12];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[2];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[13];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[7];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[1];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[4];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[10];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[5];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        num = num + num5 + array2[10];
        num13 ^= num;
        num13 = (num13 >> 16) | (num13 << 16);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 12) | (num5 << 20);
        num = num + num5 + array2[2];
        num13 ^= num;
        num13 = (num13 >> 8) | (num13 << 24);
        num9 += num13;
        num5 ^= num9;
        num5 = (num5 >> 7) | (num5 << 25);
        num2 = num2 + num6 + array2[8];
        num14 ^= num2;
        num14 = (num14 >> 16) | (num14 << 16);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 12) | (num6 << 20);
        num2 = num2 + num6 + array2[4];
        num14 ^= num2;
        num14 = (num14 >> 8) | (num14 << 24);
        num10 += num14;
        num6 ^= num10;
        num6 = (num6 >> 7) | (num6 << 25);
        num3 = num3 + num7 + array2[7];
        num15 ^= num3;
        num15 = (num15 >> 16) | (num15 << 16);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 12) | (num7 << 20);
        num3 = num3 + num7 + array2[6];
        num15 ^= num3;
        num15 = (num15 >> 8) | (num15 << 24);
        num11 += num15;
        num7 ^= num11;
        num7 = (num7 >> 7) | (num7 << 25);
        num4 = num4 + num8 + array2[1];
        num16 ^= num4;
        num16 = (num16 >> 16) | (num16 << 16);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 12) | (num8 << 20);
        num4 = num4 + num8 + array2[5];
        num16 ^= num4;
        num16 = (num16 >> 8) | (num16 << 24);
        num12 += num16;
        num8 ^= num12;
        num8 = (num8 >> 7) | (num8 << 25);
        num = num + num6 + array2[15];
        num16 ^= num;
        num16 = (num16 >> 16) | (num16 << 16);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 12) | (num6 << 20);
        num = num + num6 + array2[11];
        num16 ^= num;
        num16 = (num16 >> 8) | (num16 << 24);
        num11 += num16;
        num6 ^= num11;
        num6 = (num6 >> 7) | (num6 << 25);
        num2 = num2 + num7 + array2[9];
        num13 ^= num2;
        num13 = (num13 >> 16) | (num13 << 16);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 12) | (num7 << 20);
        num2 = num2 + num7 + array2[14];
        num13 ^= num2;
        num13 = (num13 >> 8) | (num13 << 24);
        num12 += num13;
        num7 ^= num12;
        num7 = (num7 >> 7) | (num7 << 25);
        num3 = num3 + num8 + array2[3];
        num14 ^= num3;
        num14 = (num14 >> 16) | (num14 << 16);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 12) | (num8 << 20);
        num3 = num3 + num8 + array2[12];
        num14 ^= num3;
        num14 = (num14 >> 8) | (num14 << 24);
        num9 += num14;
        num8 ^= num9;
        num8 = (num8 >> 7) | (num8 << 25);
        num4 = num4 + num5 + array2[13];
        num15 ^= num4;
        num15 = (num15 >> 16) | (num15 << 16);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 12) | (num5 << 20);
        num4 = num4 + num5 + array2[0];
        num15 ^= num4;
        num15 = (num15 >> 8) | (num15 << 24);
        num10 += num15;
        num5 ^= num10;
        num5 = (num5 >> 7) | (num5 << 25);
        array[0] ^= num ^ num9;
        array[1] ^= num2 ^ num10;
        array[2] ^= num3 ^ num11;
        array[3] ^= num4 ^ num12;
        array[4] ^= num5 ^ num13;
        array[5] ^= num6 ^ num14;
        array[6] ^= num7 ^ num15;
        array[7] ^= num8 ^ num16;
    }
}