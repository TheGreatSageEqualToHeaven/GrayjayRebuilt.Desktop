import{e as k,J as F,K as V,v as L,k as w,i as C,a as b,b as E,F as A,t as p,l as O,O as T,Q as z,j as B,U as N,W as U,V as H,z as W}from"./index-Tg9vHuMa.js";var q=p("<div>");const j=e=>{let t;const[r,m]=k({startIndex:0,endIndex:0}),R=s=>{if(!e.outerContainerRef||!t)return;const x=e.overscan??1,h=e.outerContainerRef.getBoundingClientRect(),u=Math.ceil(h.height/e.itemHeight),y=e.outerContainerRef.scrollTop-t.offsetTop,f=Math.floor(y/e.itemHeight),P=Math.max(0,Math.min(f-x,s)),n=Math.max(0,Math.min(f+u+x,s));e.onEnd&&u-n<=(e.notifyEndOnLast??1)&&e.onEnd(),m({startIndex:P,endIndex:n})},I=()=>{R(e.itemCount)},a=new ResizeObserver(s=>{I()});F(()=>{R(e.itemCount)}),V(()=>{R(e.itemCount),requestAnimationFrame(()=>{R(e.itemCount)}),a.observe(e.outerContainerRef),e.outerContainerRef?.addEventListener("scroll",I)}),L(()=>{a.unobserve(e.outerContainerRef),e.outerContainerRef?.removeEventListener("scroll",I)});const $=w(()=>{const s=r();return Array.from({length:s.endIndex-s.startIndex+1},(x,h)=>s.startIndex+h)});return(()=>{var s=q(),x=t;return typeof x=="function"?O(x,s):t=s,s.style.setProperty("position","relative"),C(s,b(A,{get each(){return $()},children:h=>(()=>{var u=q();return u.style.setProperty("position","absolute"),u.style.setProperty("left","0px"),u.style.setProperty("width","100%"),C(u,()=>e.builder(h)),E(y=>{var f=`${h*e.itemHeight}px`,P=`${e.itemHeight}px`;return f!==y.e&&((y.e=f)!=null?u.style.setProperty("top",f):u.style.removeProperty("top")),P!==y.t&&((y.t=P)!=null?u.style.setProperty("height",P):u.style.removeProperty("height")),y},{e:void 0,t:void 0}),u})()})),E(()=>e.itemCount*e.itemHeight+"px"!=null?s.style.setProperty("height",e.itemCount*e.itemHeight+"px"):s.style.removeProperty("height")),s})()};var S=p("<div>");const D=e=>{const t=T(()=>e.children),r=w(()=>{const n=t();return Array.isArray(n)?n:[n]});let m;const[R,I]=k({startIndex:0,endIndex:0});let a=[];const[$,s]=k(0),x=(n,c)=>{if(c.length==0)return 0;let l=0,o=c.length-1;for(;l<=o;){let i=Math.floor((l+o)/2);if(c[i]<n)l=i+1;else if(i>0&&c[i-1]>=n)o=i-1;else return i}return l>o?c.length-1:0},h=()=>{if(!e.outerContainerRef||!m)return;const n=e.overscan??1,c=e.outerContainerRef.scrollTop-m.offsetTop,l=e.outerContainerRef.getBoundingClientRect();let o=x(c,a),i=o,d=0;for(let _=o;d<c+l.height;_++)_<a.length?d=a[_]:d+=e.minimumItemHeight,i=_;const g=r().length,M=g-1;o=Math.max(0,Math.min(o-n,M)),i=Math.max(0,Math.min(i+n,M)),e.onEnd&&g-i<=(e.notifyEndOnLast??1)&&e.onEnd(),I({startIndex:o,endIndex:i}),i>=a.length&&requestAnimationFrame(()=>{u()})},u=()=>{if(!m)return;const n=z(R),c=r();for(let l=a.length;l<=n.endIndex;l++){const o=c[l];if(!(o instanceof Element))throw Error("Child is not an Element!");let i=o.getBoundingClientRect().height;if(i==0){console.warn("height unknown, retry with requestAnimationFrame?");break}const d=l>0?a[l-1]:0;a[l]=d+i;const g=P();l<g.length&&g[l].setTop(d)}s(a[a.length-1])},y=()=>{a=[],h()},f=new ResizeObserver(n=>{y()});V(()=>{h(),f.observe(e.outerContainerRef),e.outerContainerRef?.addEventListener("scroll",h)}),L(()=>{f.unobserve(e.outerContainerRef),e.outerContainerRef?.removeEventListener("scroll",h)});const P=w(()=>{const n=R();return r().slice(n.startIndex,n.endIndex+1).map((l,o)=>{const i=n.startIndex+o,[d,g]=k(i>0?a[i-1]:0);return{v:l,index:i,top:d,setTop:g}})});return(()=>{var n=S(),c=m;return typeof c=="function"?O(c,n):m=n,n.style.setProperty("position","relative"),C(n,b(A,{get each(){return P()},children:l=>(()=>{var o=S();return o.style.setProperty("position","absolute"),o.style.setProperty("width","100%"),C(o,()=>l.v),E(i=>{var d=`${l.top()}px`,g=l.top()!==void 0?"0px":"100vw";return d!==i.e&&((i.e=d)!=null?o.style.setProperty("top",d):o.style.removeProperty("top")),g!==i.t&&((i.t=g)!=null?o.style.setProperty("left",g):o.style.removeProperty("left")),i},{e:void 0,t:void 0}),o})()})),E(()=>$()+"px"!=null?n.style.setProperty("height",$()+"px"):n.style.removeProperty("height")),n})()};var G=p("<div style=background-color:teal;height:100%>test"),v=p("<div>"),J=p("<div>Random div in between"),K=p("<div> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam rhoncus enim ante, non fermentum est aliquam a. Nunc auctor ac magna et tristique. Fusce tellus sapien, luctus faucibus cursus eu, fringilla sed dui. Mauris tincidunt cursus ante, id feugiat sem iaculis et. Donec nisi dolor, congue sed arcu et, fringilla efficitur quam. Mauris eget leo eget massa sollicitudin sagittis vel sed neque. Ut ultricies efficitur magna, eget lobortis neque. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Sed in tellus tellus. Nulla convallis ante quis luctus vestibulum. Mauris vel justo laoreet, pretium est quis, luctus eros. Nam nec mi non purus dapibus congue. Aenean laoreet blandit dui, non ornare lacus tristique eget. Aenean dignissim viverra porttitor. Duis non gravida augue, ac vestibulum purus. Phasellus id tellus maximus nulla suscipit consectetur eget vel quam.");const X=()=>{console.log(B.getSourceState("35ae969a-a7db-11ed-afa1-0242ac120002"));let e;return b(W,{ref(t){var r=e;typeof r=="function"?r(t):e=t},get children(){return[b(N,{outerContainerRef:e,minimumHeight:200,maximumHeight:500,get children(){return G()}}),b(D,{outerContainerRef:e,minimumItemHeight:200,get children(){return[(()=>{var t=v();return t.style.setProperty("height","500px"),t.style.setProperty("background-color","pink"),t})(),(()=>{var t=v();return t.style.setProperty("height","400px"),t.style.setProperty("background-color","orange"),t})(),(()=>{var t=v();return t.style.setProperty("height","300px"),t.style.setProperty("background-color","green"),t})(),(()=>{var t=v();return t.style.setProperty("height","1000px"),t.style.setProperty("background-color","blue"),t})(),(()=>{var t=v();return t.style.setProperty("height","800px"),t.style.setProperty("background-color","yellow"),t})(),(()=>{var t=v();return t.style.setProperty("height","200px"),t.style.setProperty("background-color","purple"),t})()]}}),b(U,{outerContainerRef:e,minimumItemHeight:50,builder:t=>(()=>{var r=K(),m=r.firstChild;return r.style.setProperty("background-color","gray"),C(r,t,m),r})(),itemCount:100}),(()=>{var t=J();return t.style.setProperty("height","200px"),t.style.setProperty("background-color","teal"),t})(),b(H,{itemCount:500,itemWidth:100,itemHeight:100,builder:t=>(()=>{var r=v();return r.style.setProperty("width","100px"),r.style.setProperty("height","100px"),r.style.setProperty("background-color","gray"),C(r,t),r})(),outerContainerRef:e}),b(j,{itemCount:100,itemHeight:100,builder:t=>(()=>{var r=v();return r.style.setProperty("height","100px"),r.style.setProperty("background-color","darkgreen"),C(r,t),r})(),outerContainerRef:e}),b(H,{itemCount:500,itemWidth:100,itemHeight:100,builder:t=>(()=>{var r=v();return r.style.setProperty("width","100px"),r.style.setProperty("height","100px"),r.style.setProperty("background-color","red"),C(r,t),r})(),outerContainerRef:e})]}})};export{X as default};
